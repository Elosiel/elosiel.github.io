!function(e){var t={};function i(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,i),o.l=!0,o.exports}i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)i.d(n,o,function(t){return e[t]}.bind(null,o));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/.bootscripts/",i(i.s=206)}({1:function(e,t,i){"use strict";e.exports={getDependencyClass:function(e){if(!e)throw new Error("dependencyName required");return window.customElements.whenDefined(e).then(function(){return window.customElements.get(e)})},getFirstDependencyElement:function(e,t){if(!e)throw new Error("dependencyName required");return t||(t=document),window.customElements.whenDefined(e).then(function(){var i=t.querySelector(e);if(!i)throw new Error(e+" element cannot be found");return i})}}},12:function(e,t,i){"use strict";e.exports=function(e){var t=(i=e,window[i]=window[i]||[],window[i]);var i;return new Promise(function(e,i){t.push(function(){e(this)})})}},206:function(e,t,i){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e){return function(e){if(Array.isArray(e)){for(var t=0,i=new Array(e.length);t<e.length;t++)i[t]=e[t];return i}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function s(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function a(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e,t,i){return(l="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,i){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=r(e)););return e}(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(i):o.value}})(e,t,i||e)}function r(e){return(r=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var c=i(1).getDependencyClass,u=i(12),h=["301x50","321x50","729x90","971x90","300x251","300x601","160x601"],f="defer-until-event",p=function(e,t){var i,n=null,o=t;this.cancel=function(){clearTimeout(n),this.cancelled=!0},this.pause=function(){clearTimeout(n),o-=new Date-i},this.resume=function(){i=new Date,clearTimeout(n),n=setTimeout(e,o)},this.resume()};c("phoenix-page").then(function(e){var t=function(t){function i(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),a(this,r(i).apply(this,arguments))}var n,c,b;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(i,e.PhoenixElement),n=i,b=[{key:"observedAttributes",get:function(){return["auto-reload-paused"]}}],(c=[{key:"broadcastedEventCallback",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];e&&this.deferUntilEvent&&this.deferUntilEvent.indexOf(e)>-1&&(this._load(),this.deferUntilEvent=!1)}},{key:"connectedCallback",value:function(){var t=this;if(l(r(i.prototype),"connectedCallback",this).call(this),this.autoReload=this.hasAttribute("auto-reload"),this.closeButton=this.hasAttribute("close-button"),this.deferUntilEvent=!!this.getAttr(f)&&this.getAttr(f).split(" "),this.fixedVisible=this.hasAttribute("fixed-visible"),this.skipDynamicCall=this.hasAttribute("skip-dynamic-call"),this.trackVisibility=this.hasAttribute("track-visibility"),this.initialIndex=this.getAttr("initial-index"),this.isFilled=!1,!this.hasAttribute("config"))throw new Error("No ad configuration was specified.");var n=this;window.phxConfigQueue||(window.phxConfigQueue=[]),window.phxConfigQueue.push(function(){n.breakpoint=this.breakpoint.get()}),this.handleAd=this._handleAd.bind(this),this.adLoadedTime=0,this._reloadCount=0,this.adAuctionPromise=u("phxAdAuctionQueue"),window.phxAdvertisingQueue=window.phxAdvertisingQueue||[],this._initListeners(),this.config.slotId&&!this.hasChildNodes()&&this._addSlotDiv(this.config.slotId),this.initialIndex&&this.config.slotConfig&&this.config.slotConfig.model&&(this.config.slotConfig.model.index=this.initialIndex),e.util.whenPageLoaded().then(function(){if(!t.config.slotId||!t.config.slotConfig)throw new Error("slot id and/or slot config is missing");t.maxAdReloads=-1===t.config.adReloaderDelay?1:t.config.maxAdReloads||10,t.deferUntilEvent||t._load()})}},{key:"attributeChangedCallback",value:function(e,t,i){"auto-reload-paused"===e&&this.reloadTimer&&(this.isPaused?(this.reloadTimer.pause(),this.prebidReloadTimer.pause()):(this.reloadTimer.resume(),this.prebidReloadTimer.resume()))}},{key:"reload",value:function(e){var t=this._reloadCount,i=this.config.slotConfig;if(t<this.maxAdReloads&&!this.isPaused){if(this.hasChildNodes()){var n=this.handleAd,o=(new Date).getTime();this.prebidTime&&(o-this.prebidTime)/1e3>30&&(e=!1),window.phxAdvertisingQueue.push(function(){this.reloadAd(i,e).then(function(){(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).map(n)})})}else this._addSlotDiv(),this._load();this.autoReload&&this._setLoadTimer(),this.config.slotConfig.model&&"number"==typeof this.config.slotConfig.model.index&&this.config.slotConfig.model.index++,this._reloadCount++}}},{key:"_handleAd",value:function(e){var t=this.config.slotConfig,i=this.config.adReloaderSizeCodes||[];if(!e.filled)return this.isFilled=!1,void this._setLoadTimer();var n=e.sizeDims,o=!1;if(window.pbjs&&(o=(window.pbjs.getAdserverTargetingForAdUnitCode(this.config.slotId)||{}).hb_deal),o)this.autoReload=!1;else if(i.indexOf(n)>-1){if(t.screenSizes&&1===t.screenSizes.length&&"A"===t.screenSizes[0]&&t.model&&"fixed_bottom"===t.model.zone)if("1x1"===n)this.reloadDelay=20;else{var s=e.responseInfo&&e.responseInfo.dfp&&e.responseInfo.dfp.lineItemId;this.reloadDelay=s?20:30}}else this.autoReload=!1;var a,l,r=[];t.config&&t.config.sizes&&t.config.sizes.length&&(a=t.config.sizes,l=[],a.some(Array.isArray)?l=a.reduce(function(e,t){return e.push(Array.isArray(t)?t.join("x"):t),e},[]):2!==a.length||a.some(isNaN)?l=a:l.push(a.join("x")),r=l),r.concat(h,["1x1"]).indexOf(n)>-1?this.config.slotId&&this.closeButton&&!this.closeButtonDiv&&this._addCloseButton(this.config.slotId):this.handleNonstandardSize(),this.isFilled=!0,this.adLoadedTime=(new Date).getTime(),this._setLoadTimer()}},{key:"handleNonstandardSize",value:function(){this.closeButton&&(this.closeButtonDiv&&this.closeButtonDiv.parentElement.removeChild(this.closeButtonDiv),this.closeButton=!1,this.closeButtonDiv=void 0)}},{key:"_addCloseButton",value:function(e){var t=this;this.closeButtonDiv=document.createElement("div"),this.closeButtonDiv.classList.add("m-advertisement--close-button");var i=document.createElement("div");i.innerHTML="CLOSE",i.classList.add("m-advertisement--close-button-label"),this.closeButtonDiv.appendChild(i),this.closeButtonHandler=function(){return t.style.display="none",t._unload(),!1},this.closeButtonDiv.addEventListener("click",this.closeButtonHandler),document.getElementById(e).parentElement.appendChild(this.closeButtonDiv)}},{key:"_addSlotDiv",value:function(e){var t,i=document.createElement("div"),n=document.createElement("div"),s=this.config.visClasses||[];n.id=e,this.config.moduleClass&&s.push(this.config.moduleClass),s.push("is-placeholder"),(t=i.classList).add.apply(t,o(s)),i.appendChild(n),this.appendChild(i)}},{key:"_load",value:function(){var e=this.config.slotConfig,t=this.handleAd;window.phxAdvertisingQueue.push(function(){this.getSlotResult(e.id).then(t)}),this.skipDynamicCall||window.phxAdvertisingQueue.push(function(){this.dynamicCall({slots:[e]})}),this.autoReload&&(this.reloadDelay=parseInt(this.config.adReloaderDelay,10)||30,this.inView=!this.trackVisibility,this.trackVisibility&&this.observeVisibilityChanges())}},{key:"onChangeToVisible",value:function(){this.inView=!0,this.isPaused=!1,this.isFilled&&(this.adLoadedTime=(new Date).getTime())}},{key:"onChangeToNotVisible",value:function(){this.inView=!1,this.isPaused=!0}},{key:"_initListeners",value:function(){this.callbacks=this._bindCallbacks(),window.addEventListener("message",this.callbacks.takeover,!1),document.addEventListener("visibilitychange",this.callbacks.browserTabVisibility),document.addEventListener("phxCollection:enterFullscreen",this.callbacks.galleryOpened),document.addEventListener("phxCollection:exitFullscreen",this.callbacks.galleryClosed),this.fixedVisible&&(document.addEventListener("salishRecirculation:opened",this.callbacks.salishRecirculationOpened),document.addEventListener("salishRecirculation:closed",this.callbacks.salishRecirculationClosed))}},{key:"_setLoadTimer",value:function(){var e=this,t=this.adAuctionPromise,i=this.config.slotConfig;if(i&&i.id){if(this.reloadTimer&&this.reloadTimer.cancel(),this.prebidReloadTimer&&this.prebidReloadTimer.cancel(),this.autoReload&&!(this.reloadDelay<=0)){var n=i.id+"-"+this._reloadCount,o=Math.max(this.reloadDelay-30,0),s=Math.max(this.reloadDelay-o-3,2);this.prebidReloadTimer=new p(function(){if(e._reloadCount<=e.maxAdReloads&&!e.isHidden){var o=e;t.then(function(e){e.rerunAuction(i.id,1e3*s,n),o.prebidTime=(new Date).getTime()}).catch(function(e){console.warn("Prebid auction failed: "+e)})}},1e3*o),this.reloadTimer=new p(function(){e._reloadCount<=e.maxAdReloads&&!e.isHidden&&e.reload(n)},1e3*this.reloadDelay)}}else console.warn("Malformed ad slot config missing id; reload timer cancelled.")}},{key:"_bindCallbacks",value:function(){return{browserTabVisibility:this._browserTabVisibilityCallback.bind(this),galleryClosed:this._galleryClosed.bind(this),galleryOpened:this._galleryOpened.bind(this),salishRecirculationOpened:this._salishRecirculationOpened.bind(this),salishRecirculationClosed:this._salishRecirculationClosed.bind(this),takeover:this._takeoverCallback.bind(this)}}},{key:"_takeoverCallback",value:function(e){if(e.origin.match(window.location.host))try{var t=JSON.parse(e.data);"takeoveropened"===t.event?this.isPaused=!0:"takeoverclosed"===t.event&&this.inView&&(this.isPaused=!1)}catch(e){}}},{key:"_galleryOpened",value:function(){this.isPaused=!0}},{key:"_galleryClosed",value:function(){this.inView&&(this.isPaused=!1)}},{key:"_salishRecirculationOpened",value:function(){var e=this;if(this.isFilled&&this.smallScreen){var t=(new Date).getTime(),i=Math.max(5e3-(t-this.adLoadedTime),0);window.setTimeout(function(){e.style.display="none",e.inView=!1,e.isPaused=!0},i)}}},{key:"_salishRecirculationClosed",value:function(){this.isFilled&&this.smallScreen&&(this.style.display="",this.inView=!0,this.isPaused=!1,this.adLoadedTime=(new Date).getTime())}},{key:"_browserTabVisibilityCallback",value:function(){this.inView&&(this.isPaused="hidden"===document.visibilityState)}},{key:"_unload",value:function(){if(!this.unloaded){this.reloadTimer&&this.reloadTimer.cancel(),this.prebidReloadTimer&&this.prebidReloadTimer.cancel(),this.trackVisibility&&this.unobserveVisibilityChanges(),this.closeButton&&this.closeButtonDiv.removeEventListener("click",this.closeButtonHandler);var e=this.config.slotId;window.phxAdvertisingQueue.push(function(){this.resetAdSlot(e)}),this.autoReload&&this.callbacks&&(window.removeEventListener("message",this.callbacks.takeover),document.removeEventListener("visibilitychange",this.callbacks.browserTabVisibility),document.removeEventListener("phxCollection:enterFullscreen",this.callbacks.galleryOpened),document.removeEventListener("phxCollection:exitFullscreen",this.callbacks.galleryClosed),this.fixedVisible&&(document.removeEventListener("salishRecirculation:opened",this.callbacks.salishRecirculationOpened),document.removeEventListener("salishRecirculation:closed",this.callbacks.salishRecirculationClosed))),this.unloaded=!0}}},{key:"disconnectedCallback",value:function(){l(r(i.prototype),"disconnectedCallback",this).call(this),this._unload()}},{key:"observedBroadcastedEvents",get:function(){return this.getAttribute(f)?this.getAttribute(f).split(" "):[]}},{key:"isHidden",get:function(){return!this.fixedVisible&&!this.offsetParent}},{key:"isPaused",set:function(e){e?this.setAttribute("auto-reload-paused",e):this.removeAttribute("auto-reload-paused")},get:function(){return this.hasAttribute("auto-reload-paused")}},{key:"reloadCount",get:function(){return this._reloadCount}},{key:"smallScreen",get:function(){var e="A"===this.breakpoint?600:1e3;return window.innerHeight<e}}])&&s(n.prototype,c),b&&s(n,b),i}();window.customElements.define("phoenix-ad",t)})}});
//# sourceMappingURL=ad.min.js.map